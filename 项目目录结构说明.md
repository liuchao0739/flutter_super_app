# 项目目录结构说明

## 一、模块化架构概览

```
lib/
├── main.dart                    # 应用入口（简化后）
├── config/                      # 配置文件（主题、语言、环境变量等）
├── core/                        # 核心框架层
│   ├── router/                  # 路由系统（AutoRoute）
│   ├── state/                   # 状态管理（Riverpod）
│   ├── network/                 # 网络层（Dio + API Service）
│   ├── storage/                 # 存储层（Hive）
│   └── crash/                   # 崩溃收集服务
├── modules/                     # 功能模块（独立包，可动态加载）
│   ├── common/                  # 通用页面模块（登录、设置、启动页）
│   ├── superapp/                # 超级应用主页面（Tab导航）
│   ├── mall/                    # 商城模块
│   ├── im/                      # IM 即时通讯模块
│   ├── video/                   # 视频/直播模块
│   ├── tools/                   # 通用工具模块
│   └── industry/                # 行业扩展模块
├── services/                    # 业务服务层（跨模块通用服务）
│   ├── navigation/              # 导航服务
│   ├── payment/                 # 支付服务
│   ├── share/                   # 分享服务
│   ├── scan/                    # 扫码服务
│   ├── map/                     # 地图服务
│   ├── web/                     # WebView服务
│   ├── screenshot/              # 截图服务
│   ├── device/                  # 设备信息服务
│   ├── event/                   # 事件总线服务
│   └── utils/                   # 工具类服务
├── ui/                          # 通用组件库（待完善）
└── bridge/                      # 原生桥接层（待完善）
```

## 二、核心目录说明

### 1. `lib/main.dart` - 应用入口

包含：
- 服务初始化（Hive、Crash）
- `SuperApp` Widget（MaterialApp.router 配置）
- ProviderScope 包裹

### 2. `lib/core/` - 核心框架层

所有核心基础设施统一放在这里：

- **`core/router/`**: AutoRoute 路由配置
- **`core/state/`**: Riverpod 状态管理（Provider 定义）
- **`core/network/`**: 网络请求封装（ApiService）
- **`core/storage/`**: 本地存储（HiveService）
- **`core/crash/`**: 崩溃收集服务

### 3. `lib/modules/` - 功能模块

每个模块都是独立的业务单元，可以按需加载：

- **`modules/common/`**: 通用页面模块（登录页、设置页、启动页）
- **`modules/superapp/`**: 超级应用主页面（Tab导航容器）
- **`modules/mall/`**: 商城模块（商品、订单、购物车、支付）
- **`modules/im/`**: IM 模块（会话、消息、音视频通话）
- **`modules/video/`**: 视频模块（短视频、直播、播放器）
- **`modules/tools/`**: 工具模块（WebView、扫码、分享、地图）
- **`modules/industry/`**: 行业扩展（办公、生活服务、金融、教育）

**模块内部结构建议**：
```
modules/mall/
├── models/          # 数据模型（Product, Order, Cart）
├── pages/           # 页面（商品列表、详情、购物车）
├── services/        # 模块内服务（ProductRepository）
├── widgets/         # 模块内组件（ProductCard）
└── state/           # 模块状态（cartProvider）
```

### 4. `lib/services/` - 业务服务层

跨模块通用的业务服务，例如：
- `navigation/`: 统一导航服务
- `payment/`: 支付服务封装
- `share/`: 分享服务
- `scan/`: 扫码服务
- `map/`: 地图服务
- `web/`: WebView服务封装
- `screenshot/`: 截图服务
- `device/`: 设备信息服务（设备信息、App信息）
- `event/`: 事件总线服务（EventBus）
- `utils/`: 工具类服务

### 5. `lib/ui/` - 通用组件库

通用 UI 工具和组件：
- `ui_utils.dart`: UI工具类（如隐藏键盘等）

**待完善**：可复用的 UI 组件，例如：
- `Button`, `Card`, `Input`
- `Loading`, `Empty`, `Error`
- `Dialog`, `BottomSheet`

### 6. `lib/bridge/` - 原生桥接层

**待完善**：与原生平台交互的桥接代码，例如：
- MethodChannel 封装
- Platform 特定实现

## 四、下一步规划

1. **完善模块内部结构**：每个模块按 `models/`, `pages/`, `services/`, `widgets/` 组织
2. **构建通用组件库**：在 `ui/` 目录下创建可复用组件
3. **原生桥接层**：在 `bridge/` 目录下封装平台特定能力
4. **模块化构建**：支持模块独立构建和动态加载（长期目标）

## 五、注意事项

- 所有模块应保持独立性，避免直接依赖其他模块的实现
- 跨模块通信通过 `services/` 层或 EventBus
- 核心框架层（`core/`）不应依赖业务模块（`modules/`）
- 保持文件大小 < 300 行，遵循单一职责原则

